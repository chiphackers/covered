<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>static.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.16 -->
<h1>static.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;assert.h&gt;</code><br>
<code>#include "<a class="el" href="defines_8h-source.html">defines.h</a>"</code><br>
<code>#include "<a class="el" href="static_8h-source.html">static.h</a>"</code><br>
<code>#include "<a class="el" href="expr_8h-source.html">expr.h</a>"</code><br>
<code>#include "<a class="el" href="db_8h-source.html">db.h</a>"</code><br>
<code>#include "<a class="el" href="util_8h-source.html">util.h</a>"</code><br>
<code>#include "<a class="el" href="vector_8h-source.html">vector.h</a>"</code><br>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="defines_8h.html#a174">static_expr</a> *&nbsp;</td><td valign=bottom><a class="el" href="static_8c.html#a0">static_expr_gen_unary</a> (<a class="el" href="defines_8h.html#a174">static_expr</a> *stexp, int op, int line)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Calculates new values for unary static expressions and returns the new static expression.</em> <a href="#a0"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="defines_8h.html#a174">static_expr</a> *&nbsp;</td><td valign=bottom><a class="el" href="static_8c.html#a1">static_expr_gen</a> (<a class="el" href="defines_8h.html#a174">static_expr</a> *right, <a class="el" href="defines_8h.html#a174">static_expr</a> *left, int op, int line)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Calculates new values for static expression and returns the new static expression.</em> <a href="#a1"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="static_8c.html#a2">static_expr_calc_lsb_and_width</a> (<a class="el" href="defines_8h.html#a174">static_expr</a> *left, <a class="el" href="defines_8h.html#a174">static_expr</a> *right, int *width, int *lsb)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Calculates LSB and width for specified left/right pair for vector.</em> <a href="#a2"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="static_8c.html#a3">static_expr_dealloc</a> (<a class="el" href="defines_8h.html#a174">static_expr</a> *stexp, <a class="el" href="defines_8h.html#a182">bool</a> rm_exp)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Deallocates static_expr memory from heap.</em> <a href="#a3"></a><em></em></font><br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>

<p>
<dl compact><dt><b>
Author: </b><dd>
Trevor Williams (<a href="mailto:trevorw@charter.net">trevorw@charter.net</a>) </dl><dl compact><dt><b>
Date: </b><dd>
10/02/2002
<p>
 To accommodate the need for parameters (variables) in static expressions, the static_expr structure and supporting code was created to maintain the efficiency of static expressions that consist of known values while being able to keep track of parameter uses in static expressions.
<p>
 A static_expr structure consists of members: an int (stores known integer values) and an expression pointer. If the expression pointer is set to NULL for the given static_expr, it is assumed that the static_expr structure contains a valid, known value that can be used in immediate computations. If the expression pointer is not NULL, it is assumed that the static_expr structure contains an expression tree that needs to be evaluated at a later time (when parameters are being elaborated).
<p>
 When a static expression is being parsed and a static value (integer value) is encountered, a new static_expr is allocated from heap memory and the number field is assigned to this integer value. The new static_expr structure is then passed up the tree to be used in further calculations, if necessary. If a static expression is being parsed and an identifier (parameter) is encountered, an expression is created with an operation type of EXP_OP_SIG to indicate that a parameter is required during elaboration. The name of the necessary parameter is bound to the newly created expression.
<p>
 Using this strategy for handling static expressions, it becomes evident that we retain the efficiency of calculating static expression that consists entirely of known values (the only overhead is the allocation/deallocation of a static_expr structure from the heap). If a parameter is found during the parse stage, more effort is required to calculate the static_expr, but this is considered necessary in the larger scope of things so we will not concern ourselves with this overhead (which is fairly minimal anyways).</dl><hr><h2>Function Documentation</h2>
<a name="a2" doxytag="static.c::static_expr_calc_lsb_and_width"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void static_expr_calc_lsb_and_width </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="defines_8h.html#a174">static_expr</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>left</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="defines_8h.html#a174">static_expr</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>right</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>width</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>lsb</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Calculates LSB and width for specified left/right pair for vector.
<p>
<dl compact><dt><b>
Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>left</em>&nbsp;</td><td>
Pointer to static expression on left of vector. </td></tr>
<tr><td valign=top><em>right</em>&nbsp;</td><td>
Pointer to static expression on right of vector. </td></tr>
<tr><td valign=top><em>width</em>&nbsp;</td><td>
Calculated width of combined right/left static expressions. </td></tr>
<tr><td valign=top><em>lsb</em>&nbsp;</td><td>
Calculated lsb of combined right/left static expressions.</td></tr>
</table>
</dl>Calculates the LSB and width of a vector defined by the specified left and right static expressions. If the width cannot be obtained immediately (parameter in static expression), set width to -1. If the LSB cannot be obtained immediately (parameter in static expression), set LSB to -1. The returned width and lsb parameters can be used to size a vector instantiation.     </td>
  </tr>
</table>
<a name="a3" doxytag="static.c::static_expr_dealloc"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void static_expr_dealloc </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="defines_8h.html#a174">static_expr</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>stexp</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="defines_8h.html#a182">bool</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>rm_exp</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Deallocates static_expr memory from heap.
<p>
<dl compact><dt><b>
Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>stexp</em>&nbsp;</td><td>
Pointer to static expression to deallocate. </td></tr>
<tr><td valign=top><em>rm_exp</em>&nbsp;</td><td>
Specifies that expression tree should be deallocated.</td></tr>
</table>
</dl>Deallocates all allocated memory from the heap for the specified static_expr structure.     </td>
  </tr>
</table>
<a name="a1" doxytag="static.c::static_expr_gen"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="defines_8h.html#a174">static_expr</a>* static_expr_gen </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="defines_8h.html#a174">static_expr</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>right</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="defines_8h.html#a174">static_expr</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>left</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>op</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>line</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Calculates new values for static expression and returns the new static expression.
<p>
<dl compact><dt><b>
Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>right</em>&nbsp;</td><td>
Pointer to right static expression. </td></tr>
<tr><td valign=top><em>left</em>&nbsp;</td><td>
Pointer to left static expression. </td></tr>
<tr><td valign=top><em>op</em>&nbsp;</td><td>
Static expression operation. </td></tr>
<tr><td valign=top><em>line</em>&nbsp;</td><td>
Line number that static expression operation found on.</td></tr>
</table>
</dl><dl compact><dt><b>
Returns: </b><dd>
Returns pointer to new static_expr structure.</dl>Used by the parser to calculate a new static_expr structure based on the operation encountered while parsing. Based on the operation type specified in the argument list, performs unary operation (if both operands are static numbers, storing result into original static_expr number field and returns If only one of the operands is an expression, create a EXP_OP_STATIC expression for the other operand and create an expression consisting of these two expressions and the specified operation. If both operands are expressions, simply create a new expression consisting of those two expressions and specified operator. Store the newly create expression in the original right static_expr and deallocate the left static_expr.     </td>
  </tr>
</table>
<a name="a0" doxytag="static.c::static_expr_gen_unary"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="defines_8h.html#a174">static_expr</a>* static_expr_gen_unary </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="defines_8h.html#a174">static_expr</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>stexp</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>op</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>line</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Calculates new values for unary static expressions and returns the new static expression.
<p>
<dl compact><dt><b>
Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>stexp</em>&nbsp;</td><td>
Pointer to static expression. </td></tr>
<tr><td valign=top><em>op</em>&nbsp;</td><td>
Unary static expression operation. </td></tr>
<tr><td valign=top><em>line</em>&nbsp;</td><td>
Line number that this expression was found on in file.</td></tr>
</table>
</dl><dl compact><dt><b>
Returns: </b><dd>
Returns pointer to new static_expr structure.</dl>Used by the parser to calculate a new static_expr structure based on the unary operation encountered while parsing. Based on the operation type specified in the argument list, performs unary operation (if operand is a static number and not an expression -- parameter in operand expression tree), storing result into original static_expr number field and returns the original structure back to the calling function. If the operand is an expression, create an expression for the specified operation type and store this expression in the original expression pointer field.     </td>
  </tr>
</table>
<hr><address align="right"><small>Generated on Sun Jan 5 18:18:12 2003 for Covered by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.16 </small></address>
</body>
</html>
